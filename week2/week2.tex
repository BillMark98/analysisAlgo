\documentclass{article}  
\usepackage{graphicx}
\usepackage[parfill]{parskip}
\usepackage{mathtools}
\usepackage{hyperref}
\usepackage{amssymb,amsmath,amsthm}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

%\newcommand\stareq{\mathrel{\overset{\makebox[0pt]{\mbox{\normalfont\tiny\sffamily *}}}{=}}}
\newcommand\stareq{\mathrel{\overset{*}{=}}}
\newcommand{\myderiv}[1]{#1^\prime}
\newcommand{\mySum}[3]{\ensuremath{\sum_{#1 = #2}^{#3}}}
\newcommand{\NaturalNum}{\ensuremath{\mathbb{N}}}
\begin{document}  

Ex 2.7\\
special solution for the inhomogeneous
Ansatz: $a_n = (F_n - 1)r$\\
check: 
\begin{align*}s
	a_n &= (F_{n-1} + F_{n-2} -1) r\\
		&= (F_{n-1}-1)r + (F_{n-2} - 1)r + r\\
		&= a_{n-1} + a_{n-2} + r
\end{align*}

Ex 2.21\\
Calculate some data first:
\begin{center}
 \begin{tabular}{||c c||} 
 \hline
 n & $na_n$\\ [0.5ex] 
 \hline\hline
 1 & 0.2500\\
  2 & 0.3750\\
  3 & 0.4570\\
  4 & 0.5165\\
  5 & 0.5623\\
  6 & 0.5989\\
  7 & 0.6289\\
  8 & 0.6542\\
  9 & 0.6758\\
 10 & 0.6945\\
 11 & 0.7109\\
 12 & 0.7254\\
 13 & 0.7384\\
 14 & 0.7500\\
 15 & 0.7605\\
 16 & 0.7701\\
 17 & 0.7788\\
 18 & 0.7869\\
 19 & 0.7943\\
 20 & 0.8011\\ [1ex] 
 \hline
\end{tabular}
\end{center}

We could guess that $na_n$ is monotone increasing. \\
We first show that $a_n \leq \frac{1}{n + 1}$, indeed:
\begin{align*}
	\frac{1}{a_n} &> \frac{1}{a_{n-1}} + 1 \\
		&\cdots\\
		&> \frac{1}{a_0} + n\\
		&= 2 + n  \tag{*} \label{ineqn:anN}
\end{align*}
in particular $a_n  < \frac{1}{n+1}$\\
We list the table of $(n+2)a_n$, to illustrate that inequality(\ref{ineqn:anN}) holds:
\begin{center}
	\begin{tabular}{||c c||} 
 \hline
 n & $(n+2)a_n$\\ [0.5ex] 
  \hline\hline
 1 & 0.7500\\
  2 & 0.7500\\
  3 & 0.7617\\
  4 & 0.7748\\
  5 & 0.7872\\
  6 & 0.7985\\
  7 & 0.8086\\
  8 & 0.8178\\
  9 & 0.8260\\
 10 & 0.8334\\
 11 & 0.8402\\
 12 & 0.8463\\
 13 & 0.8519\\
 14 & 0.8571\\
 15 & 0.8619\\
 16 & 0.8663\\
 17 & 0.8705\\
 18 & 0.8743\\
 19 & 0.8779\\
 20 & 0.8812\\[1ex] 
 \hline
\end{tabular}
\end{center}

\begin{proof}
	\begin{align*}
		na_n - (n-1)a_{n-1} &= n a_{n-1} (1 - a_{n-1}) - (n-1)a_{n-1}\\
					&= a_{n-1}(1 - na_{n-1}) \\
					&\geq a_{n-1}(1- n \cdot \frac{1}{n}) \\
					&\geq 0
	\end{align*}
\end{proof}

Now since we have shown that $na_n$ is monotone increasing and we know that $a_n < \frac{1}{n}$, so in particular $na_n$ is bounded. We know from analysis that the sequence $\{na_n\}_{n\in \NaturalNum}$ converges.

Ex 22\\
\begin{align*}
	\frac{1}{{a_n}^2} &= \frac{1}{{\sin(a_{n-1}})^2} \\
		&= \frac{1}{(a_{n-1} - \frac{a_{n-1}^3}{6} + o(a_{n-1}^4))^2}\\
		&\approx \frac{1}{(a_{n-1} -\frac{a_{n-1}^3}{6})^2}\\
		&= \frac{1}{a_{n-1}^2} \cdot \frac{1}{(1-\frac{a_{n-1}^2}{6})^2}\\
		&> \frac{1}{a_{n-1}^2} \cdot (1 + \frac{2}{6}\cdot a_{n-1}^2)\\
		&= \frac{1}{a_{n-1}^2} + \frac{1}{3} \\
		&\cdots\\
		&> \frac{1}{a_{0}^2} + \frac{n}{3}\\
		&= 1 + \frac{n}{3} \\
		&> \frac{n}{3}\\
	\Rightarrow a_n &< \frac{\sqrt{3}}{\sqrt[•]{•}rt{n}}
\end{align*}
check the result:
\begin{center}
	\begin{tabular}{||c c||} 
 \hline
 n & $\frac{\sqrt{n}}{\sqrt{3}}a_n$\\ [0.5ex] 
  \hline\hline
 1 & 0.4858\\
  2 & 0.6088\\
  3 & 0.6784\\
  4 & 0.7247\\
  5 & 0.7580\\
  6 & 0.7835\\
  7 & 0.8036\\
  8 & 0.8200\\
  9 & 0.8337\\
 10 & 0.8452\\
 11 & 0.8552\\
 12 & 0.8638\\
 13 & 0.8714\\
 14 & 0.8781\\
 15 & 0.8841\\
 16 & 0.8895\\
 17 & 0.8944\\
 18 & 0.8988\\
 19 & 0.9028\\[1ex] 
 \hline
\end{tabular}
\end{center}

We see again that the $\sqrt{n}a_n$ is increasing:
\begin{align*}
	\frac{\sqrt{n}a_n}{\sqrt{n-1}a_{n-1}} &= \frac{\sqrt{n}}{\sqrt{n-1}} \cdot \frac{\sin(a_{n-1}}{a_{n-1}} \\
	&> \frac{\sqrt{n}}{\sqrt{n-1}} \cdot \frac{a_{n-1} - \frac{a_{n-1}^3}{6}}{a_{n-1}}\\
	&> \frac{\sqrt{n}}{\sqrt{n-1}} \cdot (1 - \frac{a_{n-1}^2}{6}) \\
	&> \frac{\sqrt{n}}{\sqrt{n-1}} \cdot (1 - \frac{1}{6}\cdot\frac{3}{n})\\
	&= \frac{\sqrt{n}}{\sqrt{n-1}} \cdot (1 - \frac{1}{2n})\\
	&= \frac{2n-1}{2\sqrt{n}\sqrt{n-1}}\\
	&= \frac{n-\frac{1}{2}}{\sqrt{n(n-1)}}\\
	&= \sqrt{\frac{n^2 - n + \frac{1}{4}}{n^2-n}} > 1
\end{align*}
in particular $\sqrt{n}a_n$ has a limit and thus $a_n = \Theta(\sqrt{n})$

Ex 35\\
multiply both sides with $(n-2)!$
we get $a_n = \frac{F_n}{n!}$, where $F_n$ is the \emph{Fibonacci number}

Ex 39\\
$a_0 = 3$:
\begin{center}
	\begin{tabular}{||c c||}
	\hline
	n & $a_n$ \\ [0.8ex]
	\hline \hline
	  1 & 7.0000\\
  2 & 47.0000\\
  3 & 2207.0000\\
  4 & 4870847.0000\\
  5 & 23725150497407.0156\\[1ex]
  \hline
	\end{tabular}
\end{center}

$a_0 = 4$:
\begin{center}
	\begin{tabular}{||c c||}
	\hline
	  1 & 14.0000\\
  2 & 194.0000\\
  3 & 37634.0000\\
  4 & 1416317954.0000\\
  5 & 2005956546822744320.0000\\[1ex]
  \hline
	\end{tabular}
\end{center}

$a_0 = \frac{3}{2}$:
should be complex. 
\begin{align*}
	a_n &= (\frac{1}{2} \cdot 2 \cdot e^{\theta})^{2^n} + (\frac{1}{2} \cdot 2 \cdot e^{-\theta})^{2^n} \\
	&= 2\cos(2^n\theta)
\end{align*}
where $\theta = \arctan(\frac{\sqrt{7}}{3})$ \\\\


Problem \\
We first give a general sum formula of the summand $(i+k)(i+k-1)\cdots(i+1)$.
Def $G(z) := \frac{1}{1-z}$, and $H^{k}(z) = \sum_{n = 0}^{\infty} (\sum_{i = 0}^{i = n} (i+k)(i+k-1)\cdots(i+1)) z^n $, Then it follows that:
\begin{align*}
	H^{k}(z) &= G^{(k)}(z) \cdot G(z) \\
		&= \frac{k!}{(1-z)^{k+1}} \cdot \frac{1}{1-z}\\
		&= \frac{(k-1)!}{(1-z)^{k+2}}\\
		&= \sum_{l = 0}^{\infty} \binom{n + k + 1}{k+1} \cdot k! z^n\\
		&= \sum_{l = 0}^{\infty} \frac{(n+k+1)(n+k)\cdots(n+1)}{k+1} z^n \\
		\Rightarrow \sum_{i = 0}^{n} (i + k)(i+k-1)\cdots(i+1) &= \frac{(n+k+1)(n+k)\cdots(n+1)}{k+1}
\end{align*}\\\\

Question:\\
$na_n = (n-3)a_{n-1} + n$, for $n > 2$, $a_0 = a_1 = a2 = 0$, find $a_n$:\\\\
The factor is $\frac{n-3}{n} \cdot \frac{n-4}{n-1} \cdot \frac{n-5}{n-2}\cdots \frac{3}{6} \frac{2}{5} \frac{1}{4} = \frac{6}{n(n-1)(n-2)}$. Multiplying the factor gives the recursion:
\[
	n(n-1)(n-2)a_n = (n-1)(n-2)(n-3)a_{n-1} + n(n-1)(n-2)
\]
Def $b_n := n(n-1)(n-2)a_n$, we have 
\begin{align*}
	b_n &= n(n-1)(n-2) + b_{n-1} \\
		&= \sum_{i = 3}^n i(i-1)(i-2) + 0\\
		&= \sum_{i=0}^{n-3} (i+1)(i+2)(i+3) \\
		&= \frac{(n+1)n(n-1)(n-2)}{4} \\
		\Rightarrow a_n &= \frac{n+1}{4}
\end{align*}
\end{document}